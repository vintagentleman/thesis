\usepackage[
    backend=biber,
    bibencoding=utf8,
    style=gost-authoryear,
    language=auto,
    autolang=other,
    clearlang=true,
    sortcites=true,
    movenames=false,
    minbibnames=3,
    maxbibnames=5
]{biblatex}

% Сортировка библиографии
\DeclareSourcemap{
    \maps[datatype=bibtex]{
        \map{
            \step[fieldsource=langid, match=russian, final]
            \step[fieldset=presort, fieldvalue={a}]
        }
        \map{
            \step[fieldsource=langid, notmatch=russian, final]
            \step[fieldset=presort, fieldvalue={z}]
        }
    }
}

% Отображение диссертаций без дублирования автора
\DeclareBibliographyDriver{thesis}{%
    \usebibmacro{bibindex}%
    \usebibmacro{begentry}%
    \usebibmacro{heading}%
    \newunit
    \usebibmacro{author}%
    \setunit*{\labelnamepunct}%
    \usebibmacro{thesistitle}%
    \setunit{\respdelim}%
    \newunit\newblock
    \printlist[semicolondelim]{specdata}%
    \newunit
    \usebibmacro{institution+location+date}%
    \newunit\newblock
    \usebibmacro{chapter+pages}%
    \newunit
    \printfield{pagetotal}%
    \newunit\newblock
    \usebibmacro{doi+eprint+url+note}%
    \newunit\newblock
    \usebibmacro{addendum+pubstate}%
    \setunit{\bibpagerefpunct}\newblock
    \usebibmacro{pageref}%
    \newunit\newblock
    \usebibmacro{related:init}%
    \usebibmacro{related}%
    \usebibmacro{finentry}
}

% Короткое тире в интервалах страниц
\DefineBibliographyExtras{russian}{\protected\def\bibrangedash{\textendash}}

% Счётчик цитируемых источников
\newtotcounter{citnum}
\AtEveryBibitem{\stepcounter{citnum}}
