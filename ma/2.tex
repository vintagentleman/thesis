\chapter{Прецедентная разметка текстов СКАТ}

В настоящей главе пойдёт речь о втором компоненте разработанного грамматического модуля, направленном на частичную автоматизацию морфологической разметки текстов СКАТ.

\section{Опыт древнерусского подкорпуса НКРЯ}

Идея о том, что при определённом уровне накопленного материала дальнейшая лингвистическая разметка может осуществляться не с нуля, не нова. "<Базы данных текстовых прецедентов с приписанными вручную морфологическими пометами"> перечисляются в \autocite[47]{baranov:2015} первыми среди средств автоматизации разметки, распространённых в корпусной палеославистике.

Примером исторического корпуса русского языка, в котором данная идея успешно получила своё воплощение, может служить древнерусский подкорпус Национального корпуса русского языка (НКРЯ). Корпус составляют книжные тексты древнерусских рукописей XI--XIV~вв.\ суммарным объёмом порядка 500~тыс.\ словоупотреблений \autocite[101--102]{mishina_pichkhadze:2015}. Архаический характер их грамматики, огромная вариативность в орфографии и другие связанные проблемы исключают автоматизацию разметки, например, путём создания грамматических словарей (в отличие от более "<современных"> церковнославянского и старорусского подкорпусов, где данный вопрос либо решён \autocite[250--253]{polyakov:2014}, либо находится в процессе решения \autocite{lyashevskaya:2016}), поэтому их разметка ещё с середины 2000-х~гг.\ осуществляется вручную силами экспертов"=славистов. Очевидно, что затраты на столь скрупулёзный труд остаются крайне высокими.

В \autocite{archangel_mishina_pichkhadze:2014} описана среда Morphy, разработанная в Институте русского языка для грамматической разметки древних славянских текстов и используемая в древнерусском подкорпусе НКРЯ. Процесс аннотирования может осуществляться как вручную, так и полуавтоматически; в последнем случае "<программа использует информацию из уже размеченных текстов, т.",е.\ использует прецедентные разборы, а исследователь проверяет и редактирует предложенный вариант разбора. Если предложенных разборов несколько, а в данном контексте правильным является только один, исследователь убирает ненужные варианты разбора, возникающие из-за омонимии словоформ"> \autocite[29]{archangel_mishina_pichkhadze:2014}. В обоих случаях также привлекаются сведения из сводного словаря лемм: при вводе экспертом леммы, которая в нём присутствует, "<словарные грамматические признаки">, т.",е.\ граммемы классификационных категорий подставляются автоматически \autocite[28]{archangel_mishina_pichkhadze:2014}.

\section{Реализация прецедентной разметки для СКАТ}
\label{sec:precedent}

Реализованный компонент грамматического модуля СКАТ решает аналогичную задачу, но с поправкой на более привычный для коллектива СКАТ табличный формат представления разметки и ориентацией на студентов как конечных её исполнителей. С программной точки зрения компонент в свою очередь состоит из двух связанных между собой компонентов.

Первый подкомпонент интегрирован в конвертер для размеченных текстов как отдельный режим его работы~"--- \texttt{pkl} (см. \ref{sec:module}). В данном режиме обрабатываемые словоформы сериализуются в хранилище данных типа "<ключ~"--- значение">, где в качестве ключей выступают их нормализованные формы, в качестве значений~"--- массивы из зафиксированных в разметке кортежей из морфологических разборов (тегсетов).

Тегсеты записываются в хранилище в несколько упрощённом виде. В разметке СКАТ особо фиксируются словоформы, обнаруживающие переходные грамматические явления: так, развитие категории одушевлённости отражается значением падежа \texttt{вин/род}, где тег до косой черты обозначает ожидаемую граммему, а тег после~"--- фактическую; при записи в хранилище сохраняются только последние. Также отдельного упоминания заслуживают личные формы глаголов. Очевидно, что морфологически идентичные формы могут выражать разные грамматические значения наклонения и времени; однако в полностью неразмеченных текстах тот контекст, который позволил бы отличить синтетические глагольные формы от их омонимов в составе аналитических, априори не известен. В связи с этим для личных форм глаголов в хранилище фиксируются, помимо части речи, только граммемы лица (или рода в случае эловых причастий) и числа.

Второй дочерний компонент (\foreignlanguage{english}{\texttt{annotator.py}}) принимает на вход неразмеченный текст, уже сегментированный на токены.\footnote{%
    Для сегментации в несколько видоизменённом виде использован фрагмент модуля \texttt{texttoxml.py}, написанный для дипломной работы \autocite{alexeev:2009}.
} Каждая словоформа нормализуется и ищется в созданном ранее хранилище; её присутствие позволяет использовать ассоциированные с ней кортежи граммем для прецедентной разметки. Однако ограничиваться лишь теми тегсетами, которые содержатся в хранилище, нельзя: материал размеченных житий, на основе которых оно конструируется, весьма ограничен, и словоформы в его составе представлены парадигмой, далёкой от полной; привлечение только \textit{реально} существующих тегсетов не учитывает \textit{потенциальной} грамматической омонимии между членами словоизменительных парадигм.

Для решения этой проблемы был составлен перечень множеств тегсетов, план выражения которых омонимичен.\footnote{%
    Перечень в формате JSON приведён в файле \href{https://github.com/vintagentleman/scat-v2/blob/master/src/utils/clusters.json}{\texttt{src/utils/clusters.json}}.
} При анализе словоформ все тегсеты последовательно сверяются с данным перечнем и при нахождении в одном из множеств последнее объединяется с множеством всех тегсетов, потенциально присущих словоформе.

Результат работы компонента~"--- таблица формата \texttt{.xlsx}, по содержимому столбцов практически полностью соответствующий спецификации разметки СКАТ (\ref{sec:annotation}).\footnote{%
    Отступления касаются лишь тех личных форм глаголов, в грамматическом значении которых отсутствует время: в таком случае столбцы с граммемами лица (рода) и числа должны смещаться на единицу влево, однако поскольку время, как было сказано выше, не фиксируется в хранилище, нет возможности узнать о факте его отсутствия в размечаемом тексте. Полуавтоматическая разметка таких словоформ подлежит посткоррекции.
} При этом все однозначно определяемые граммемы заносятся в таблицу как есть; все те, в отношении которых зафиксирована потенциальная омонимия, явно не записываются, но соответствующие ячейки выделяются цветом фона, а при наведении все варианты грамматических значений становятся доступны из выпадающего списка (используется механизм проверки данных (\foreignlanguage{english}{data validation}), доступный в \foreignlanguage{english}{Microsoft Excel}; рис.~\ref{fig:precedent}).

В порядке организации разметки как учебной деятельности в рамках филологической практики таблица сегментирована на листы, на каждый из которых попадает ограниченное множество словоформ (предполагается, что количество листов соответствует количеству студентов в группе). При запуске компонента оба числа настраиваются; также подлежит конфигурации порядковый номер токена, вплоть до которого содержимое анализируемого жития следует игнорировать,~"--- это вызвано тем, что большинство текстов частично уже размечены и требуют доразметки не с начала.

Если путём прецедентной разметки та или иная словоформа размечается полностью и однозначно, то при подсчёте объёма "<порции"> словоформ, приходящейся на очередного студента, она не учитывается. Это позволяет существенно увеличить объём работы, подлежащей выполнению.

\begin{figure}[t]
    \centering
    \includegraphics[width=\textwidth]{precedent} % TODO
    \caption{Прецедентная разметка жития Александра Свирского}
    \label{fig:precedent}
\end{figure}

\section{Опыт по внедрению прецедентной разметки}

В рамках промежуточной аттестации в декабре 2018~г.\ автором совместно с Алексеевой~Е.",Л.\ был проведён опыт по внедрению прецедентной разметки в учебную филологическую практику: студенты 2~курса образовательной программы бакалавриата "<Прикладная, компьютерная и математическая лингвистика"> СПбГУ в рамках филологической практики выполнили часть морфологической разметки жития Александра Свирского на материале вывода разработанного компонента.

Для тогдашней версии программы ещё не был создан перечень потенциальных грамматических омонимов~"--- учитывались только тегсеты, фактически имеющиеся в прецедентной базе. Ввиду ограниченности объёма размеченной выборки это привело к ожидаемому результату: многие словоформы ошибочно размечались как однозначные и игнорировались при расчёте объёма очередного фрагмента. Это в свою очередь сказалось на их объёме (в среднем он составил 524,7 при выставленном номинальном объёме 350) и потребовало их дополнительной экспертной предобработки.

Тем не менее, в результате проверяющим экспертом было отмечено, что совершённых экспериментальной группой ошибок было значительно меньше, чем обычно демонстрируют студенты второго курса. Можно выдвинуть следующие предположения, обусловившие данное обстоятельство:

\begin{asparaitem}
    \item с точки зрения морфологии из синтетического строя церковнославянского языка, при котором один аффикс одновременно способен выражать целый ряд грамматических значений, следует их взаимная обусловленность~"--- становится проще предсказывать недостающие граммемы у не полностью размеченных словоформ исходя из уже имеющихся;
    \item с точки зрения синтаксиса важную роль следует отвести согласованию и координации словоформ: если, например, в сочетании прилагательного с существительным у первого известны все граммемы, а у последнего нет, но они с очевидностью составляют словосочетание, то заполнение недостающих граммем достигается тривиальным копированием.
\end{asparaitem}

\section*{Выводы}
\addcontentsline{toc}{section}{Выводы}

Был разработан модуль для аннотирования текстов СКАТ с использованием прецедентов. Предварительный опыт его внедрения в практику промежуточной аттестации продемонстрировал, что формирование фрагментов, подлежащих разметке, с его помощью способно вызвать не только количественный, но и качественный прирост мероприятий по её дальнейшему пополнению.
