\documentclass[specialist, subf, substylefile = spbu.rtx]{disser}
\usepackage[a4paper, includefoot, left = 2cm, right = 2cm, top = 2cm, bottom = 2cm, headsep = 1cm, footskip = 1cm]{geometry}

% Локализация
\usepackage{fontspec}
\usepackage{xecyr}
\usepackage[polish, french, english, russian]{babel}

% Шрифты
\defaultfontfeatures{Ligatures = TeX, Mapping = tex-text, HyphenChar = "002D}
\setmainfont[Ligatures = {TeX, Historic}]{Times New Roman}
\setsansfont{Arial}
\setmonofont{Consolas}
\newfontfamily{\agio}{AgioUnicode}

% Оформление
\usepackage[babel]{microtype}
\usepackage[autostyle]{csquotes}
\usepackage[
    xetex,
    bookmarksnumbered,
    bookmarksopen,
    colorlinks,
    allcolors = blue,
    hyperfootnotes = false
]{hyperref}

% Глубина нумерации разделов и оглавления
\setcounter{secnumdepth}{3}
\setcounter{tocdepth}{3}

% Нумерация страниц снизу и по центру
\pagestyle{footcenter}
\chapterpagestyle{footcenter}

% Сноски
\usepackage[bottom, perpage]{footmisc}

% Списки
\usepackage{paralist}
\setdefaultleftmargin{5ex}{}{}{}{}{}

% Таблицы
\usepackage{booktabs}
\usepackage{multirow}
\usepackage{ltablex}
\keepXColumns
\renewcommand{\aboverulesep}{0.1pt}
\renewcommand{\belowrulesep}{0.1pt}
\newcommand*{\thead}[1]{\multicolumn{1}{c}{\bfseries #1}}

% Графика
\usepackage{textcomp}
\usepackage{graphicx}
\usepackage{subcaption}
\graphicspath{{fig/}}

% Код
\usepackage{fancyvrb}

% Библиография
\usepackage{csquotes}
\usepackage[
    backend = biber,       % Движок
    bibencoding = utf8,    % Кодировка файлов с библиографическими БД
    style = gost-numeric,  % Стиль цитирования по ГОСТ
    language = auto,       % Получение языка из babel/polyglossia; ссылки на страницы на языке оригинала
    autolang = other,      % Многоязычная библиография
    clearlang = true,      % Внутренний сброс поля language при совпадении с языком из babel/polyglossia
    sortcites = true,      % Сортировка затекстовых ссылок при цитировании
    movenames = false,     % Не менять местами заголовок и список авторов, если последних больше четырёх
    minbibnames = 3,       % Число авторов, отображаемое при сокращении
    maxbibnames = 5        % Максимальное число авторов в препозиции
]{biblatex}

\addbibresource{./bib/scat.bib}
\addbibresource{./bib/stuff.bib}

% Сортировка библиографии
\DeclareSourcemap{
    \maps[datatype = bibtex]{
        \map{
            \step[fieldsource = langid, match = russian, final]
            \step[fieldset = presort, fieldvalue = {a}]
        }
        \map{
            \step[fieldsource = langid, notmatch = russian, final]
            \step[fieldset = presort, fieldvalue = {z}]
        }
    }
}

% Счётчик библиографических источников
\usepackage{totcount}
\newtotcounter{citnum}
\AtEveryBibitem{\stepcounter{citnum}}

% Короткое тире во всех интервалах страниц
\DefineBibliographyExtras{russian}{\protected\def\bibrangedash{\textendash}}

\sloppy

\begin{document}

% Титульный лист, аннотация, оглавление
\input{title}
\input{abstract}
\tableofcontents

% Текст работы
\input{intro}
\input{1}
\input{2}
\input{3}
\input{concl}

% Библиография
\printbibliography[heading = bibintoc]

% Приложения
\appendix
\input{app-a}
\input{app-b}

\end{document}
